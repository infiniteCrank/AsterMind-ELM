<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ELM Drum Generator • AsterMind (ELM / KernelELM / OnlineELM + Worker)</title>
  <link rel="stylesheet" href="./styles.css" />
  <link rel="icon" href="data:;base64,=" />
</head>

<body>
  <header>
    <div class="bar">
      <div class="chip">ELM Drum Generator • AsterMind</div>

      <div class="row">
        <button id="trainBtn">Train</button>
        <button id="genBtn" disabled>Generate 8 Bars</button>
        <button id="stopBtn" disabled>Stop</button>
      </div>

      <div class="grow"></div>

      <div class="row">
        <label class="chip" style="display:flex;align-items:center;">Temp
          <input id="temp" class="slider" type="range" min="0.6" max="1.4" step="0.05" value="1.0" />
          <span id="tempVal" class="val">1.0</span>
        </label>
        <label class="chip" style="display:flex;align-items:center;">top-K
          <input id="topk" class="slider" type="range" min="5" max="40" step="1" value="24" />
          <span id="topkVal" class="val">24</span>
        </label>
      </div>
    </div>

    <div class="bar" style="border-top:1px solid rgba(90,209,255,.12)">
      <details class="settings">
        <summary class="chip">Settings</summary>
        <div class="row" style="margin-top:8px;">
          <div class="field">
            <span>Engine</span>
            <select id="engine">
              <option value="elm">ELM</option>
              <option value="kernel">KernelELM (Nyström)</option>
              <option value="online">OnlineELM (RLS)</option>
            </select>
          </div>

          <div class="field">
            <span>N (window)</span>
            <input id="nWindow" type="number" min="4" max="64" step="1" value="16" style="width:70px" />
          </div>

          <div class="field">
            <span>Hidden</span>
            <input id="hidden" type="number" min="16" max="512" step="16" value="128" style="width:80px" />
          </div>

          <div class="field">
            <span>λ (ridge)</span>
            <input id="lambda" type="number" min="0.0001" max="0.2" step="0.0001" value="0.01" style="width:90px" />
          </div>

          <div class="field">
            <span>Activation</span>
            <select id="activation">
              <option>tanh</option>
              <option selected>relu</option>
              <option>leakyrelu</option>
              <option>sigmoid</option>
              <option>linear</option>
              <option>gelu</option>
            </select>
          </div>

          <div class="field">
            <label class="row" style="gap:6px; align-items:center;">
              <input id="useWorker" type="checkbox" checked>
              <span>Use WebWorker</span>
            </label>
          </div>
        </div>

        <div class="row" id="kernelRow" style="margin-top:8px; display:none;">
          <div class="field">
            <span>Kernel</span>
            <select id="kernelType">
              <option value="rbf" selected>rbf</option>
              <option value="linear">linear</option>
              <option value="poly">poly</option>
              <option value="laplacian">laplacian</option>
            </select>
          </div>
          <div class="field" id="gammaField">
            <span>γ</span>
            <input id="gamma" type="number" min="0.0001" step="0.0001" value="0.0625" style="width:90px" />
          </div>
          <div class="field" id="polyField" style="display:none">
            <span>deg</span><input id="degree" type="number" min="2" max="6" step="1" value="2" style="width:70px" />
            <span>coef0</span><input id="coef0" type="number" step="0.1" value="1" style="width:70px" />
          </div>
          <div class="field">
            <span>m (landmarks)</span>
            <input id="mLandmarks" type="number" min="16" max="512" step="16" value="128" style="width:90px" />
          </div>
          <div class="field">
            <label class="row" style="gap:6px; align-items:center;">
              <input id="whiten" type="checkbox" checked>
              <span>Whiten Kmm</span>
            </label>
          </div>
        </div>

        <div class="muted">Kernel γ default ≈ 1 / inputDim; try small (0.01–0.25) for RBF.</div>
      </details>
    </div>
  </header>

  <div class="panel">
    <canvas id="c"></canvas>
    <div class="legend">
      <div class="dot kick"></div><span class="small">KICK</span>
      <div class="dot snare"></div><span class="small">SNARE</span>
      <div class="dot hat"></div><span class="small">HAT</span>
      <span class="small">• 16 steps/bar • Tokens: WAIT_1, ON_K, ON_S, ON_H</span>
    </div>
    <div id="status"></div>
  </div>

  <div class="panel small">
    <strong>How it works</strong> — one-hot(last <code>N</code> tokens) → random feature map (ELM / Kernel Nyström) →
    solve β with ridge (closed-form).
    Generation feeds back sampled tokens and schedules WebAudio. Powered by <code>window.astermind</code>.
  </div>

  <!-- AsterMind UMD bundle (you provide this file at web root) -->
  <script src="/astermind.umd.js"></script>
  <!-- App -->
  <script type="module" src="/src/main.js?v=1007"></script>
</body>

</html>