<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Extreme Learning Machine — JS Engineer Primer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <style>
    :root{
      --bg:#050c1f; --panel:#0b1633; --ink:#e5efff; --muted:#a7b8e8; --accent:#5ad1ff; --good:#6ee7a2; --warn:#facc15; --bad:#fb7185;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:radial-gradient(1200px 700px at 50% -200px,#0b1633 0%,#050c1f 55%,#020614 100%);
      color:var(--ink); font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;
    }
    .app{display:flex; flex-direction:column; min-height:100vh;}
    header{
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      padding:14px 16px; background:linear-gradient(180deg,rgba(90,209,255,0.12),rgba(90,209,255,0.0));
      border-bottom:1px solid #13244f;
    }
    header h1{font-size:1.05rem; margin:0; font-weight:600; letter-spacing:0.2px}
    .nav{display:flex; gap:8px;}
    button{
      background:#102043; color:var(--ink); border:1px solid #1f3570; border-radius:10px; padding:8px 12px; cursor:pointer;
    }
    button:hover{background:#12265a}
    button[disabled]{opacity:.6; cursor:not-allowed}
    main{flex:1; display:flex; justify-content:center; padding:16px}
    .slide{
      width:min(1100px,100%); display:grid; grid-template-columns: 1.1fr .9fr; gap:16px;
      padding:16px; background:rgba(7,16,41,0.66); border:1px solid #14244e; border-radius:16px; box-shadow:0 10px 30px rgba(0,0,0,.30);
      grid-template-rows: auto 1fr; /* hero + content */
    }
    .left, .right{min-height:380px; background:rgba(8,19,44,0.72); border:1px solid #182d61; border-radius:14px; overflow:hidden; position:relative}
    .panel{padding:14px 14px 10px 14px; height:100%; display:flex; flex-direction:column; gap:10px;}
    h2{margin:0 0 6px 0; font-size:1.05rem}
    p{margin:.25rem 0; color:var(--muted); line-height:1.35}
    ul{margin:.4rem 0 .6rem 1.1rem; color:var(--muted)}
    label{font-size:.9rem; color:var(--muted)}
    select,input[type=range]{width:100%}
    .kv{display:grid; grid-template-columns: 1fr auto; gap:8px; align-items:center}
    .row{display:flex; gap:10px; flex-wrap:wrap}
    .chip{padding:4px 8px; border:1px solid #203a7c; border-radius:999px; font-size:.8rem; color:#bcd0ff; background:#0c1a3d}
    .canvasWrap{flex:1; border:1px dashed #253f85; border-radius:10px; overflow:hidden; background:#071332}
    canvas{display:block; width:100%; height:100%}
    .footerBar{display:flex; gap:10px; justify-content:flex-end; margin-top:8px}
    .code{font-family: ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace; background:#0c1a3d; border:1px solid #203a7c; border-radius:8px; padding:8px; font-size:.88rem; color:#cfe1ff; overflow:auto}
    .note{font-size:.85rem; color:#93a9e8}
    .ok{color:var(--good)} .warn{color:var(--warn)} .bad{color:var(--bad)}
    @media (max-width: 980px){
      .slide{grid-template-columns: 1fr; }
      .left,.right{min-height:300px}
    }
    [hidden]{display:none !important;}

    /* Hero cap w/ parallax */
    .slide > .hero{
      grid-column: 1 / -1;
      height: clamp(500px, 26vh, 500px);
      border-radius: 14px;
      border: 1px solid #182d61;
      background-position:center;
      background-repeat: no-repeat;
      background-size: cover;
      position: relative;
      overflow: hidden;
      margin-bottom: 10px;
      box-shadow: 0 12px 30px rgba(0,0,0,.28);
      will-change: background-position;
    }
    .slide > .hero::after{
      content:""; position:absolute; inset:0;
      background: linear-gradient(180deg, rgba(5,12,31,0) 0%, rgba(5,12,31,.25) 60%, rgba(5,12,31,.55) 100%);
      pointer-events:none;
    }
    .hero .caption{
      position:absolute; left:12px; bottom:10px;
      font-size:.9rem; color:#cfe1ff; opacity:.95;
      background: rgba(12,26,61,.55);
      border:1px solid #203a7c;
      padding:4px 8px; border-radius:8px;
    }

    /* Legends / tips reused */
    .canvasWrap { position: relative; }
    .heat-legend{display:flex; align-items:center; gap:8px; margin-top:6px; font-size:.85rem; color:var(--muted);}
    .legend-bar{
      width:160px; height:10px; border-radius:999px; border:1px solid #203a7c;
      background: linear-gradient(90deg, hsla(0,90%,60%,.85), hsla(210,30%,20%,.15) 50%, hsla(200,90%,60%,.85));
    }
    .legend-chip{ padding:2px 8px; border:1px solid #203a7c; border-radius:999px; }
    .encode-tip,.hidden-tip,.bp-tip{
      position:absolute; top:0; left:0; transform: translate(8px,-28px);
      background:#0c1a3d; border:1px solid #203a7c; padding:4px 6px; border-radius:6px;
      font-size:.8rem; color:#cfe1ff; display:none; pointer-events:none; white-space:nowrap;
    }

    html, body { scroll-behavior: smooth; }

    .slide > .hero{
      background: none;               /* no background image */
      height: clamp(320px, 45vh, 600px);
      display: grid; place-items: center;
    }
    .slide > .hero img{
      width: 100%;
      height: 100%;
      object-fit: contain;            /* show full image; letterbox if needed */
    }

  </style>
</head>
<body>
<div class="app">
  <header>
    <h1>Extreme Learning Machines — a visual primer for JS engineers</h1>
    <div class="nav">
      <button id="prevBtn">◀ Back</button>
      <div class="chip" id="slideLabel">Slide 1 / 7</div>
      <button id="nextBtn">Next ▶</button>
    </div>
  </header>

  <main>

    <!-- SLIDE 1: OVERVIEW -->
    <section class="slide" id="slide0" data-stage="overview">
      <figure class="hero">
        <img src="images/intro.png" alt="ELM intro artwork" />
        <div class="caption">What we’ll cover</div>
      </figure>
      <div class="left">
        <div class="panel">
          <h2>What we’ll learn</h2>
          <ul>
            <li><strong>Neurons:</strong> tiny functions with a weight, a bias, and a “squiggle”.</li>
            <li><strong>Vectorization:</strong> turning text into numbers a neuron can read.</li>
            <li><strong>Why training is hard:</strong> too many knobs to tune by hand.</li>
            <li><strong>Backprop (classic):</strong> how networks usually learn (slow in loops).</li>
            <li><strong>ELM (shortcut):</strong> random hidden layer + one-shot solve.</li>
            <li><strong>Prediction:</strong> try the trained model on a row.</li>
          </ul>
          <p class="note">We’ll keep it JavaScript-friendly: sliders, canvases, and small code snippets.</p>
        </div>
      </div>
      <div class="right">
        <div class="panel">
          <h2>Roadmap</h2>
          <ol>
            <li>Neuron basics</li>
            <li>Neuron demo</li>
            <li>Vectorization</li>
            <li>Why hand-tuning fails → pseudo backprop</li>
            <li>ELM training (one-shot)</li>
            <li>Prediction</li>
          </ol>
        </div>
      </div>
    </section>

    <!-- SLIDE 2: NEURON INTRO -->
    <section class="slide" id="slideIntroNeuron" data-stage="neuron">
      <figure class="hero" data-hero="images/intro.png">
        <div class="caption">Neurons are just mini functions</div>
      </figure>
      <div class="left">
        <div class="panel">
          <h2>Neurons in plain JS</h2>
          <p>A neuron takes a number <code>x</code>, nudges it with <code>w</code> (weight) and <code>b</code> (bias): <code>z = w*x + b</code>, then applies a “squiggle” (<em>activation</em>) like ReLU or tanh: <code>y = g(z)</code>.</p>
          <div class="code"><pre>// one neuron
const z = w * x + b;      // line
const y = activation(z);  // bend it</pre></div>
          <p class="note">That’s it. Networks are just lots of these chained together.</p>
        </div>
      </div>
      <div class="right">
        <div class="panel">
          <h2>Vocabulary</h2>
          <ul>
            <li><strong>w</strong> (weight): how strongly x pushes up/down</li>
            <li><strong>b</strong> (bias): a constant shift</li>
            <li><strong>activation</strong>: the “squiggle” shape (ReLU, tanh, …)</li>
          </ul>
          <p class="note">Next slide: play with one neuron live.</p>
        </div>
      </div>
    </section>

    <!-- SLIDE 3: NEURON DEMO -->
    <section class="slide" id="slide1" data-stage="neuron">
      <div class="left">
        <div class="panel">
          <h2>Neuron demo</h2>
          <p>Adjust <em>w</em> and <em>b</em>, choose an activation, and watch <code>y = g(w·x + b)</code>.</p>
          <div class="row">
            <div style="flex:1">
              <label>Activation</label>
              <select id="actSelect">
                <option value="relu">ReLU</option>
                <option value="leakyRelu">LeakyReLU</option>
                <option value="sigmoid">Sigmoid</option>
                <option value="tanh">tanh</option>
              </select>
            </div>
            <div class="chip">Live chart</div>
          </div>
          <div class="kv"><label>Weight (w)</label><span id="wVal">1.00</span></div>
          <input id="wRange" type="range" min="-5" max="5" step="0.05" value="1">
          <div class="kv"><label>Bias (b)</label><span id="bVal">0.00</span></div>
          <input id="bRange" type="range" min="-5" max="5" step="0.05" value="0">
          <div class="canvasWrap" style="height:260px"><canvas id="neuronCanvas"></canvas></div>
          <div class="note">“Affine” = compute <code>z = w·x + b</code> (a line), then bend it with <code>g(z)</code>.</div>
        </div>
      </div>
      <div class="right">
        <div class="panel">
          <h2>Try</h2>
          <p>Set <strong>w</strong> negative and compare <strong>ReLU</strong> vs <strong>tanh</strong>.</p>
          <div class="code"><pre>// y = g(w·x + b)
const z = w * x + b;
const y = activation(z);</pre></div>
        </div>
      </div>
    </section>

    <!-- SLIDE 4: VECTORIZATION -->
    <section class="slide" id="slide2" data-stage="input">
      <div class="left">
        <div class="panel">
          <h2>Vectorization (text → numbers)</h2>
          <p>Select a row. We’ll encode text to a feature vector and draw a mini heatmap.</p>
          <div class="row">
            <select id="rowSelect" style="flex:1"></select>
            <button id="encodeBtn">Encode →</button>
          </div>
          <div class="canvasWrap" style="height:260px; position:relative">
            <canvas id="encodeCanvas"></canvas>
          </div>
          <div id="tokensOut" class="code" style="min-height:80px"></div>
        </div>
      </div>
      <div class="right">
        <div class="panel">
          <h2>Plain English</h2>
          <p>Text → numbers (features). Each square is one number. <span class="note">Blue = positive, red = negative, brighter = larger magnitude.</span></p>
          <p>Any reasonable encoding works for ELM. We just need a vector.</p>
        </div>
      </div>
    </section>

    <!-- SLIDE 5: WHY HAND TUNING IS HARD → PSEUDO BACKPROP -->
    <section class="slide" id="slideBP" data-stage="backprop">
      <div class="left">
        <div class="panel">
          <h2>Why manual tuning doesn’t scale</h2>
          <p>A real network can have thousands of <em>w</em> and <em>b</em>. You can’t tweak those by hand.</p>
          <p><strong>Backpropagation</strong> automates tuning in loops: measure error → nudge weights a bit → repeat.</p>
          <div class="kv"><label>“Learning rate”</label><span id="bpLRVal">0.20</span></div>
          <input id="bpLR" type="range" min="0.01" max="1" step="0.01" value="0.20">
          <div class="canvasWrap" style="height:260px; position:relative">
            <canvas id="bpCanvas"></canvas>
          </div>
          <div class="note">This is a <em>visual</em> mock: weights wiggle and loss trends down to show the idea.</div>
        </div>
      </div>
      <div class="right">
        <div class="panel">
          <h2>What to look for</h2>
          <ul>
            <li>Left heatmap = hidden weights changing each step</li>
            <li>Right line = “loss” trending down</li>
            <li>Learning rate too high → noisy; too low → slow</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- SLIDE X: HIDDEN LAYER (random W,b + project H) -->
    <section class="slide" id="slideHidden" data-stage="hidden">
      <div class="left">
        <div class="panel">
          <h2>Hidden layer (Random &amp; Project)</h2>
          <p>Random projection: <code>H = g(X·W + b)</code>. Shuffle to reseed the hidden layer; project the currently encoded row.</p>
          <div class="row">
            <span class="chip">Hidden size</span>
            <input id="hiddenSizeHL" type="range" min="4" max="1024" step="1" value="32" style="flex:1">
            <span class="note" id="hiddenSizeHLVal">32</span>
            <button id="shuffleBtnHL" title="Reseed W,b">Shuffle Hidden</button>
            <button id="previewHBtnHL" title="Project current x">Project H = g(X·W + b)</button>
          </div>
          <div class="canvasWrap" style="height:260px; position:relative">
            <canvas id="hiddenCanvas"></canvas>
            <div class="hidden-tip"></div>
          </div>
          <div id="WPreview" class="code" style="min-height:80px"></div>
        </div>
      </div>
      <div class="right">
        <div class="panel">
          <h2>What you’re seeing</h2>
          <p>Heatmap: each <em>row</em> is a hidden neuron; each <em>column</em> is an input feature. Colors show sign &amp; magnitude of <code>W[i,j]</code>. Green bars on the right show <code>H = g(Wx + b)</code> for the selected text.</p>
          <p class="note">Tip: go to “Vectorization”, click <em>Encode →</em>, come back, then hit <em>Project</em>.</p>
        </div>
      </div>
    </section>

    <!-- SLIDE 6: ELM TRAINING (ONE SHOT) -->
    <section class="slide" id="slide4" data-stage="output">
      <div class="left">
        <div class="panel">
          <h2>ELM: random hidden + one-shot solve</h2>
          <p>We solve <code>Hβ ≈ Y</code> once (pseudoinverse / ridge). No loops.</p>
          <div class="row">
            <button id="trainBtn">Train on snippet</button>
            <span class="chip">Hidden size</span>
            <input id="hiddenSize" type="range" min="4" max="1024" step="1" value="32" style="flex:1">
            <span class="note" id="hiddenSizeVal">32</span>
            <span style="flex:1"></span>
            <button id="downloadBtn" title="Save W,b,β and basis">Download model</button>
            <button id="resetBtn" title="Clear model & basis">Reset</button>
          </div>
          <div id="solveOut" class="code" style="min-height:100px">Waiting…</div>
          <div class="canvasWrap" style="height:220px">
            <canvas id="betaCanvas"></canvas>
          </div>
        </div>
      </div>
      <div class="right">
        <div class="panel">
          <h2>Plain English</h2>
          <p>Random hidden features act like coordinates. We draw a straight separator there. Done.</p>
          <p class="note">This is the shortcut: train in one shot vs many backprop loops.</p>
        </div>
      </div>
    </section>

    <!-- SLIDE 7: PREDICTION -->
    <section class="slide" id="slidePred" data-stage="predict">
      <div class="left">
        <div class="panel">
          <h2>Prediction demo</h2>
          <p>Pick a row and run the trained model.</p>
          <div class="row">
            <select id="predRowSelect" style="flex:1"></select>
            <button id="predictBtn" title="Train first" disabled>Predict</button>
          </div>
          <div id="predOut" class="code" style="min-height:120px">Train on the previous slide, then predict.</div>
        </div>
      </div>
      <div class="right">
        <div class="panel">
          <h2>Reading the result</h2>
          <p><strong>Predicted label</strong>, ground truth, and per-class probabilities.</p>
          <p class="note">If the truth exists in the sample, we’ll mark ✓ or ✗.</p>
        </div>
      </div>
    </section>

  </main>

  <div style="padding:8px 16px; display:flex; gap:8px; align-items:center; justify-content:space-between;">
    <div id="status" class="note">Worker: <span id="workerStatus">connecting…</span></div>
    <div class="footerBar">
      <!-- Buttons auto-generated by JS -->
    </div>
  </div>
</div>

<script src="elm-demo.js"></script>
</body>
</html>
